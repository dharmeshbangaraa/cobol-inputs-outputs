Impact Analysis Report

User Story: Add Transaction Type Field to Batch Processing and Reporting  
- Add TRANSACTION-TYPE (PIC X(10)) to the transaction record layout in the copybook used by both batch processing and reporting programs.
- Update batch processing program to accept, store, and process the new field.
- Update reporting program to read and display the new field.
- Ensure backward compatibility for missing transaction type values.

**Total impacted components:** 3 primary COBOL programs/copybooks, with several affected paragraphs and control paths.  
**Change complexity:** Medium-High. The change affects a core data structure (transaction record) and both processing and reporting chains, requiring updates in multiple programs and careful handling for backward compatibility.

---

**Ranked Impact List**:

| Program/Copybook         | Impact | Nature   | Affected Paragraphs/Sections           | Dependency Path                                  |
|--------------------------|--------|----------|----------------------------------------|--------------------------------------------------|
| TRNREC.cpy (copybook)    | High   | Direct   | 01 TRANSACTION-RECORD, TRN-TYPE        | Used by PORTTRAN.cbl, RPTPOS00.cbl, others       |
| PORTTRAN.cbl             | High   | Direct   | 2000-PROCESS-TRANSACTIONS, 2100-VALIDATE-TRANSACTION, 2120-CHECK-TRANSACTION-TYPE, 2200-UPDATE-POSITIONS, 2210-PROCESS-BUY, 2220-PROCESS-SELL, 2230-PROCESS-TRANSFER, 2240-PROCESS-FEE, 2300-UPDATE-AUDIT-TRAIL | Calls TRNREC.cpy, main batch processing          |
| RPTPOS00.cbl             | High   | Direct   | 2000-PROCESS-REPORT, 2100-TRANSACTION-ACTIVITY, 2200-WRITE-TRANSACTION-DETAIL | Calls TRNREC.cpy, main reporting program         |

---

**JSON Metadata**:
```json
{
  "impactAnalysis": {
    "userStory": "Add Transaction Type Field to Batch Processing and Reporting",
    "impactedComponents": [
      {
        "programName": "TRNREC.cpy",
        "impactScore": 1.0,
        "impactLevel": "High",
        "impactType": "Direct",
        "affectedParagraphs": ["01 TRANSACTION-RECORD", "TRN-TYPE"],
        "dependencyPath": ["TRNREC.cpy"],
        "rationale": "Core copybook defining the transaction record structure; the TRANSACTION-TYPE field must be added here. All programs using this copybook will inherit the new field."
      },
      {
        "programName": "PORTTRAN.cbl",
        "impactScore": 0.95,
        "impactLevel": "High",
        "impactType": "Direct",
        "affectedParagraphs": [
          "2000-PROCESS-TRANSACTIONS",
          "2100-VALIDATE-TRANSACTION",
          "2120-CHECK-TRANSACTION-TYPE",
          "2200-UPDATE-POSITIONS",
          "2210-PROCESS-BUY",
          "2220-PROCESS-SELL",
          "2230-PROCESS-TRANSFER",
          "2240-PROCESS-FEE",
          "2300-UPDATE-AUDIT-TRAIL"
        ],
        "dependencyPath": ["PORTTRAN.cbl", "TRNREC.cpy"],
        "rationale": "Main batch transaction processing program. Reads/writes transaction records, validates and processes TRN-TYPE, and updates audit trail. Directly impacted by changes to the transaction record structure."
      },
      {
        "programName": "RPTPOS00.cbl",
        "impactScore": 0.93,
        "impactLevel": "High",
        "impactType": "Direct",
        "affectedParagraphs": [
          "2000-PROCESS-REPORT",
          "2100-TRANSACTION-ACTIVITY",
          "2200-WRITE-TRANSACTION-DETAIL"
        ],
        "dependencyPath": ["RPTPOS00.cbl", "TRNREC.cpy"],
        "rationale": "Main reporting program. Reads transaction records and generates reports. Needs to be updated to read and display the new TRANSACTION-TYPE field."
      }
    ]
  }
}
```

---

**Visualization**:

```mermaid
graph TD
    subgraph Copybooks
        TRNREC[TRNREC.cpy<br/>(Transaction Record)]
    end
    subgraph Batch Processing
        PORTTRAN[PORTTRAN.cbl<br/>(Transaction Processing)]
    end
    subgraph Reporting
        RPTPOS[RPTPOS00.cbl<br/>(Transaction Reporting)]
    end

    TRNREC -- High Impact --> PORTTRAN
    TRNREC -- High Impact --> RPTPOS

    style TRNREC fill:#ffcccc,stroke:#d33,stroke-width:2px
    style PORTTRAN fill:#ffcccc,stroke:#d33,stroke-width:2px
    style RPTPOS fill:#ffcccc,stroke:#d33,stroke-width:2px
```

---

**Reasoning**:

- **TRNREC.cpy** is the central copybook for the transaction record. Adding TRANSACTION-TYPE here is required for both processing and reporting programs to recognize the new field.
- **PORTTRAN.cbl** is the main batch processing program for transactions. It reads/writes transaction records, validates TRN-TYPE, and updates positions and audit trails. All logic that references or processes transaction types must be updated to use the new field and handle missing/legacy values.
- **RPTPOS00.cbl** is the main reporting program. It reads transaction records and generates reports. It must be updated to read and display the new TRANSACTION-TYPE field, and handle cases where the field is missing (for backward compatibility).
- All three components are tightly coupled via the transaction record structure, and changes to the copybook will propagate to all users.
- No unrelated programs or false positives were identified, as the dependency is clear and direct through the shared copybook and explicit transaction processing/reporting logic.

**End of Report**
