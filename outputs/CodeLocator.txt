# COBOL Legacy System Impact Analysis Report  
**User Story:** Enable Real-Time Market Price Feed Integration for Dynamic Portfolio Updates  
**Repository:** https://github.com/dharmeshbangaraa/COBOL-Legacy-Benchmark-Suite  
**User Story Source:** https://github.com/dharmeshbangaraa/cobol-inputs-outputs/blob/master/user-story/user_story_COBOL_Legacy_benchmark_suite_major.txt

---

## Summary

**Overview:**  
This user story introduces real-time market price feed integration, requiring the system to ingest external price updates, recalculate portfolio valuations, update risk metrics, and maintain audit logs and historical price records. The change affects data ingestion, valuation logic, error handling, and reporting.

**Total High-Impact Components Identified:** 6  
**Complexity Assessment:**  
- High complexity: Touches core batch and portfolio update logic, error handling, audit logging, and reporting.
- Multiple direct and indirect dependencies across batch, portfolio, and audit/reporting programs.
- Requires robust error handling and historical data management.

---

## Ranked Impact List

| Program File Path                        | Impact | Nature  | Affected Paragraphs/Sections                | Dependency Path                        |
|------------------------------------------|--------|---------|---------------------------------------------|----------------------------------------|
| src/programs/portfolio/PORTUPDT.cbl      | High   | Direct  | 0000-MAIN, 2000-PROCESS, 2100-PROCESS-UPDATE, 2200-APPLY-UPDATE | [PORTUPDT]                             |
| src/programs/batch/RCVPRC00.cbl          | High   | Direct  | 0000-MAIN, 2000-PROCESS-RECOVERY, 1200-VALIDATE-REQUEST | [RCVPRC00]                             |
| src/programs/batch/RPTAUD00.cbl          | High   | Direct  | 0000-MAIN, 2000-PROCESS-REPORT, 1100-OPEN-FILES | [RPTAUD00]                             |
| src/programs/portfolio/PORTTRAN.cbl      | High   | Indirect| 2000-PROCESS-TRANSACTIONS, 2100-VALIDATE-TRANSACTION, 2110-CHECK-PORTFOLIO | [PORTTRAN]                             |
| src/programs/batch/BCHCTL00.cbl          | High   | Indirect| 1000-PROCESS-INITIALIZE, 2000-CHECK-PREREQUISITES, 3000-UPDATE-STATUS | [BCHCTL00]                             |
| src/copybook/common/AUDITLOG.cpy         | High   | Direct  | AUDIT-LOG-ENTRY, AUDIT-LOG-HEADER           | [PORTUPDT, RPTAUD00, PORTTRAN]         |

---

## JSON Metadata

```json
{
  "impactAnalysis": {
    "userStory": "Enable Real-Time Market Price Feed Integration for Dynamic Portfolio Updates",
    "impactedComponents": [
      {
        "programFilePath": "src/programs/portfolio/PORTUPDT.cbl",
        "impactScore": 0.98,
        "impactLevel": "High",
        "impactType": "Direct",
        "affectedParagraphs": ["0000-MAIN", "2000-PROCESS", "2100-PROCESS-UPDATE", "2200-APPLY-UPDATE"],
        "dependencyPath": ["PORTUPDT"],
        "rationale": "Primary program for updating portfolio positions; must process real-time price updates and trigger valuation recalculations."
      },
      {
        "programFilePath": "src/programs/batch/RCVPRC00.cbl",
        "impactScore": 0.96,
        "impactLevel": "High",
        "impactType": "Direct",
        "affectedParagraphs": ["0000-MAIN", "2000-PROCESS-RECOVERY", "1200-VALIDATE-REQUEST"],
        "dependencyPath": ["RCVPRC00"],
        "rationale": "Handles batch receipt and processing of price feeds; will require modification for real-time polling and error handling."
      },
      {
        "programFilePath": "src/programs/batch/RPTAUD00.cbl",
        "impactScore": 0.95,
        "impactLevel": "High",
        "impactType": "Direct",
        "affectedParagraphs": ["0000-MAIN", "2000-PROCESS-REPORT", "1100-OPEN-FILES"],
        "dependencyPath": ["RPTAUD00"],
        "rationale": "Generates audit reports; must log price feed errors and maintain historical price records for compliance."
      },
      {
        "programFilePath": "src/programs/portfolio/PORTTRAN.cbl",
        "impactScore": 0.93,
        "impactLevel": "High",
        "impactType": "Indirect",
        "affectedParagraphs": ["2000-PROCESS-TRANSACTIONS", "2100-VALIDATE-TRANSACTION", "2110-CHECK-PORTFOLIO"],
        "dependencyPath": ["PORTTRAN"],
        "rationale": "Processes portfolio transactions; indirectly impacted as valuation logic and position updates depend on real-time prices."
      },
      {
        "programFilePath": "src/programs/batch/BCHCTL00.cbl",
        "impactScore": 0.91,
        "impactLevel": "High",
        "impactType": "Indirect",
        "affectedParagraphs": ["1000-PROCESS-INITIALIZE", "2000-CHECK-PREREQUISITES", "3000-UPDATE-STATUS"],
        "dependencyPath": ["BCHCTL00"],
        "rationale": "Batch control logic; must ensure batch processes are synchronized with real-time price updates and error recovery."
      },
      {
        "programFilePath": "src/copybook/common/AUDITLOG.cpy",
        "impactScore": 0.90,
        "impactLevel": "High",
        "impactType": "Direct",
        "affectedParagraphs": ["AUDIT-LOG-ENTRY", "AUDIT-LOG-HEADER"],
        "dependencyPath": ["PORTUPDT", "RPTAUD00", "PORTTRAN"],
        "rationale": "Copybook for audit logging; will be extended to record price feed errors, timestamps, and historical price data."
      }
    ]
  }
}
```

---

## Visualization

```mermaid
graph TD
    PORTUPDT["src/programs/portfolio/PORTUPDT.cbl (High)"]
    RCVPRC00["src/programs/batch/RCVPRC00.cbl (High)"]
    RPTAUD00["src/programs/batch/RPTAUD00.cbl (High)"]
    PORTTRAN["src/programs/portfolio/PORTTRAN.cbl (High)"]
    BCHCTL00["src/programs/batch/BCHCTL00.cbl (High)"]
    AUDITLOG["src/copybook/common/AUDITLOG.cpy (High)"]

    RCVPRC00 --> PORTUPDT
    PORTUPDT --> PORTTRAN
    PORTUPDT --> AUDITLOG
    RPTAUD00 --> AUDITLOG
    PORTTRAN --> AUDITLOG
    BCHCTL00 --> RCVPRC00
```

---

## Reasoning Behind Each Component

- **PORTUPDT.cbl**: Central to portfolio updates; must process incoming price feeds and recalculate positions.
- **RCVPRC00.cbl**: Responsible for receiving price feeds; will be modified for real-time integration and error handling.
- **RPTAUD00.cbl**: Generates audit logs and reports; must capture price feed errors and maintain historical records.
- **PORTTRAN.cbl**: Handles transactions; valuation logic depends on up-to-date prices.
- **BCHCTL00.cbl**: Batch control; ensures batch jobs are coordinated with real-time updates and recovery.
- **AUDITLOG.cpy**: Audit logging copybook; extended for new error and historical price logging requirements.

---

**Note:**  
- Only existing files in the repository are included.
- All listed components have a High impact score and are directly or indirectly involved in the real-time price feed integration.
- No extra files or false positives are present.
