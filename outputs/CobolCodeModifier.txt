
[1] TRANSACTION.CPY /copybooks/TRANSACTION.CPY

       01  TRANSACTION-RECORD.
           05  TRANSACTION-ID         PIC 9(10).
           05  TRANSACTION-DATE       PIC X(08).
           05  TRANSACTION-AMOUNT     PIC S9(9)V99 COMP-3.
           05  TRANSACTION-TYPE       PIC X(02).
           05  ACCOUNT-NUMBER         PIC 9(12).
           05  CHANNEL-CODE           PIC X(03).    * Added for channel identification

Summary: Added CHANNEL-CODE field (PIC X(03)) to the transaction record structure to capture the source channel of each transaction.

[2] TRNREC.CPY /copybooks/TRNREC.CPY

       01  TRNREC-RECORD.
           05  TRNREC-ID              PIC 9(10).
           05  TRNREC-DATE            PIC X(08).
           05  TRNREC-AMOUNT          PIC S9(9)V99 COMP-3.
           05  TRNREC-TYPE            PIC X(02).
           05  TRNREC-ACCOUNT         PIC 9(12).
           05  TRNREC-CHANNEL-CODE    PIC X(03).    * Added for channel identification

Summary: Added TRNREC-CHANNEL-CODE field (PIC X(03)) to the TRNREC record layout for channel tracking.

[3] TSTGEN00.CBL /programs/TSTGEN00.CBL

      * ... [Unchanged code above]
           FD  TRANSACTION-FILE
               LABEL RECORDS ARE STANDARD
               BLOCK CONTAINS 0 RECORDS
               RECORD CONTAINS 45 CHARACTERS
               DATA RECORD IS TRANSACTION-RECORD.

      * ... [Unchanged code above]
           2300-GEN-TRANSACTION.
               MOVE ... TO TRANSACTION-ID
               MOVE ... TO TRANSACTION-DATE
               MOVE ... TO TRANSACTION-AMOUNT
               MOVE ... TO TRANSACTION-TYPE
               MOVE ... TO ACCOUNT-NUMBER
               MOVE WS-CHANNEL-CODE TO CHANNEL-CODE   * Set channel code for each transaction

      * ... [Unchanged code above]
           2320-WRITE-TRAN-RECORD.
               WRITE TRANSACTION-RECORD.
      * ... [Unchanged code below]

Summary: Updated FD and logic to include CHANNEL-CODE in transaction generation and output. Ensured the new field is populated and written to the file.

[4] RPTPOS00.CBL /programs/RPTPOS00.CBL

      * ... [Unchanged code above]
           FD  TRANSACTION-FILE
               LABEL RECORDS ARE STANDARD
               BLOCK CONTAINS 0 RECORDS
               RECORD CONTAINS 45 CHARACTERS
               DATA RECORD IS TRANSACTION-RECORD.

      * ... [Unchanged code above]
           2200-PROCESS-TRANSACTIONS.
               READ TRANSACTION-FILE INTO TRANSACTION-RECORD
               IF CHANNEL-CODE = 'ATM'
                   ADD 1 TO ATM-COUNT
               ELSE IF CHANNEL-CODE = 'MOB'
                   ADD 1 TO MOBILE-COUNT
               ELSE IF CHANNEL-CODE = 'BRN'
                   ADD 1 TO BRANCH-COUNT
               END-IF
      * ... [Unchanged code below]

Summary: Updated FD and processing logic to read and report on CHANNEL-CODE, enabling channel-based analytics in reporting.

[5] UTLVAL00.CBL /programs/UTLVAL00.CBL

      * ... [Unchanged code above]
           FD  TRANSACTION-FILE
               LABEL RECORDS ARE STANDARD
               BLOCK CONTAINS 0 RECORDS
               RECORD CONTAINS 45 CHARACTERS
               DATA RECORD IS TRANSACTION-RECORD.

      * ... [Unchanged code above]
           1100-OPEN-FILES.
               OPEN INPUT TRANSACTION-FILE

      * ... [Unchanged code above]
           2420-CHECK-TRANSACTION-FORMAT.
               IF CHANNEL-CODE NOT = 'ATM'
                  AND CHANNEL-CODE NOT = 'MOB'
                  AND CHANNEL-CODE NOT = 'BRN'
                   DISPLAY 'INVALID CHANNEL-CODE: ' CHANNEL-CODE
                   MOVE 'ERR' TO CHANNEL-CODE
               END-IF
      * ... [Unchanged code below]

Summary: Updated FD and validation logic to check the new CHANNEL-CODE field for valid values during transaction file validation.

[6] TSTVAL00.CBL /programs/TSTVAL00.CBL

      * ... [Unchanged code above]
           FD  TRANSACTION-FILE
               LABEL RECORDS ARE STANDARD
               BLOCK CONTAINS 0 RECORDS
               RECORD CONTAINS 45 CHARACTERS
               DATA RECORD IS TRANSACTION-RECORD.

      * ... [Unchanged code above]
           1100-OPEN-FILES.
               OPEN INPUT TRANSACTION-FILE

      * ... [Unchanged code above]
           2100-EXECUTE-TEST.
               READ TRANSACTION-FILE INTO TRANSACTION-RECORD
               IF CHANNEL-CODE = SPACES
                   DISPLAY 'CHANNEL-CODE MISSING IN TEST DATA'
               END-IF
      * ... [Unchanged code below]

Summary: Updated FD and test validation logic to ensure CHANNEL-CODE is present in test transaction data.

[7] POSREC.CPY /copybooks/POSREC.CPY

       01  POSREC-RECORD.
           05  POSREC-ID              PIC 9(10).
           05  POSREC-DATE            PIC X(08).
           05  POSREC-AMOUNT          PIC S9(9)V99 COMP-3.
           05  POSREC-TYPE            PIC X(02).
           05  POSREC-ACCOUNT         PIC 9(12).
           05  POSREC-CHANNEL-CODE    PIC X(03).    * Added for channel identification

Summary: Added POSREC-CHANNEL-CODE field (PIC X(03)) to POSREC record layout for consistency with transaction structure.

[8] RPTAUD00.CBL /programs/RPTAUD00.CBL

      * ... [Unchanged code above]
           FD  TRANSACTION-FILE
               LABEL RECORDS ARE STANDARD
               BLOCK CONTAINS 0 RECORDS
               RECORD CONTAINS 45 CHARACTERS
               DATA RECORD IS TRANSACTION-RECORD.

      * ... [Unchanged code above]
           2100-PROCESS-AUDIT-TRAIL.
               READ TRANSACTION-FILE INTO TRANSACTION-RECORD
               DISPLAY 'AUDIT: ' TRANSACTION-ID ' ' CHANNEL-CODE

      * ... [Unchanged code above]
           2200-PROCESS-ERROR-LOG.
               IF CHANNEL-CODE = 'ERR'
                   DISPLAY 'ERROR: INVALID CHANNEL-CODE IN TRANSACTION ' TRANSACTION-ID
               END-IF
      * ... [Unchanged code below]

Summary: Updated FD and audit/error reporting logic to include CHANNEL-CODE in audit trails and error logs.
