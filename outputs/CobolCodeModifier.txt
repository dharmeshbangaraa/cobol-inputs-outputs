[File 1] PNL-CALC-PROG.cbl src/programs/calc/PNL-CALC-PROG.cbl

       IDENTIFICATION DIVISION.
       PROGRAM-ID.    PNL-CALC-PROG.
       AUTHOR.        LEGACY TEAM.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT PNL-INPUT ASSIGN TO 'PNLIN.DAT'.
           SELECT PNL-OUTPUT ASSIGN TO 'PNLOUT.DAT'.

       DATA DIVISION.
       FILE SECTION.
       FD  PNL-INPUT.
       01  PNL-IN-REC.
           05  PORTFOLIO-ID      PIC X(08).
           05  TRADE-DATE        PIC X(08).
           05  TRADE-AMT         PIC S9(13)V99 COMP-3.
           05  COST-AMT          PIC S9(13)V99 COMP-3.

       FD  PNL-OUTPUT.
       01  PNL-OUT-REC.
           05  PORTFOLIO-ID      PIC X(08).
           05  TRADE-DATE        PIC X(08).
           05  PNL-AMT           PIC S9(13)V99 COMP-3.

       WORKING-STORAGE SECTION.
       01  WS-PNL-AMT            PIC S9(13)V99 COMP-3.
       01  WS-TEMP-AMT           PIC S9(13)V99 COMP-3.

       PROCEDURE DIVISION.
       MAIN-LOOP.
           OPEN INPUT PNL-INPUT
           OPEN OUTPUT PNL-OUTPUT
           PERFORM UNTIL EOF-FLAG = 'Y'
               READ PNL-INPUT
                   AT END
                       MOVE 'Y' TO EOF-FLAG
                   NOT AT END
                       PERFORM CALC-PNL
                       PERFORM MOVE-TO-OUTPUT
               END-READ
           END-PERFORM
           PERFORM FINALIZE
           CLOSE PNL-INPUT
           CLOSE PNL-OUTPUT
           STOP RUN.

       CALC-PNL.
           COMPUTE WS-PNL-AMT = TRADE-AMT - COST-AMT ROUNDED
*-- Change: Added ROUNDED to ensure P&L is rounded to two decimals as per user story
           .

       MOVE-TO-OUTPUT.
           MOVE PORTFOLIO-ID TO PNL-OUT-REC
           MOVE TRADE-DATE TO PNL-OUT-REC
           MOVE WS-PNL-AMT TO PNL-AMT ROUNDED
*-- Change: Added ROUNDED to MOVE to ensure output is rounded to two decimals
           WRITE PNL-OUT-REC
           .

       FINALIZE.
           EXIT.
           .

[Summary Change Report]
- Added ROUNDED keyword to the COMPUTE statement in CALC-PNL to ensure P&L is rounded to two decimals.
- Added ROUNDED keyword to the MOVE statement in MOVE-TO-OUTPUT for consistent rounding in output.
- Inline comments added for traceability.

[File 2] PORTVAL.cpy src/copybook/db2/PORTVAL.cpy

       01  PORTVAL-RECORD.
           05  PORTFOLIO-ID         PIC X(08).
           05  TRADE-DATE           PIC X(08).
           05  PNL-AMT              PIC S9(13)V99 COMP-3.
*-- Change: Confirmed PNL-AMT is defined with two decimals (V99) for DB2 storage as required

[Summary Change Report]
- Verified PNL-AMT field is defined as PIC S9(13)V99 COMP-3, matching DB2 DECIMAL(15,2) requirement.
- Inline comment added for traceability.

[File 3] TSTVAL00.cbl src/programs/test/TSTVAL00.cbl

       IDENTIFICATION DIVISION.
       PROGRAM-ID.    TSTVAL00.
       AUTHOR.        QA TEAM.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.

       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  TEST-CASE-ID           PIC 9(04).
       01  TEST-TRADE-AMT         PIC S9(13)V99 COMP-3.
       01  TEST-COST-AMT          PIC S9(13)V99 COMP-3.
       01  EXPECTED-PNL           PIC S9(13)V99 COMP-3.
       01  ACTUAL-PNL             PIC S9(13)V99 COMP-3.
       01  TEST-RESULT            PIC X(10).

       PROCEDURE DIVISION.
       MAIN-TEST.
           PERFORM 2100-EXECUTE-TEST
           PERFORM 2600-VALIDATE-RESULTS
           STOP RUN.

       2100-EXECUTE-TEST.
           COMPUTE ACTUAL-PNL = TEST-TRADE-AMT - TEST-COST-AMT ROUNDED
*-- Change: Added ROUNDED to match production logic for rounding to two decimals
           .

       2600-VALIDATE-RESULTS.
           IF ACTUAL-PNL = EXPECTED-PNL
               MOVE 'PASS' TO TEST-RESULT
           ELSE
               MOVE 'FAIL' TO TEST-RESULT
           END-IF
           DISPLAY 'Test Case: ' TEST-CASE-ID ' Result: ' TEST-RESULT
           .

[Summary Change Report]
- Added ROUNDED keyword to COMPUTE in 2100-EXECUTE-TEST to ensure test matches new rounding logic.
- Inline comment added for traceability.

[File 4] RPTPOS00.cbl src/programs/batch/RPTPOS00.cbl

       IDENTIFICATION DIVISION.
       PROGRAM-ID.    RPTPOS00.
       AUTHOR.        REPORT TEAM.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.

       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  WS-PNL-AMT            PIC S9(13)V99 COMP-3.
       01  WS-PNL-AMT-DISPLAY    PIC Z(13).99.

       PROCEDURE DIVISION.
       MAIN-REPORT.
           PERFORM 2110-FORMAT-POSITION
           PERFORM 2300-WRITE-SUMMARY
           STOP RUN.

       2110-FORMAT-POSITION.
           MOVE WS-PNL-AMT TO WS-PNL-AMT-DISPLAY ROUNDED
*-- Change: Added ROUNDED to MOVE for display formatting to two decimals
           .

       2300-WRITE-SUMMARY.
           DISPLAY 'Portfolio P&L: ' WS-PNL-AMT-DISPLAY
           .

[Summary Change Report]
- Added ROUNDED keyword to MOVE in 2110-FORMAT-POSITION for display output.
- Inline comment added for traceability.

[File 5] RPTAUD00.cbl src/programs/batch/RPTAUD00.cbl

       IDENTIFICATION DIVISION.
       PROGRAM-ID.    RPTAUD00.
       AUTHOR.        AUDIT TEAM.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.

       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  WS-PNL-AMT            PIC S9(13)V99 COMP-3.
       01  WS-PNL-AMT-DISPLAY    PIC Z(13).99.

       PROCEDURE DIVISION.
       MAIN-AUDIT.
           PERFORM 2100-PROCESS-AUDIT-TRAIL
           PERFORM 2300-WRITE-SUMMARY
           STOP RUN.

       2100-PROCESS-AUDIT-TRAIL.
           MOVE WS-PNL-AMT TO WS-PNL-AMT-DISPLAY ROUNDED
*-- Change: Added ROUNDED to MOVE for audit display formatting to two decimals
           .

       2300-WRITE-SUMMARY.
           DISPLAY 'Audit P&L: ' WS-PNL-AMT-DISPLAY
           .

[Summary Change Report]
- Added ROUNDED keyword to MOVE in 2100-PROCESS-AUDIT-TRAIL for audit display output.
- Inline comment added for traceability.
