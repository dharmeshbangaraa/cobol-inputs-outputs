[File 1] RPTPOS00.cbl src/programs/batch/RPTPOS00.cbl

       IDENTIFICATION DIVISION.
       PROGRAM-ID. RPTPOS00.
       AUTHOR. CLAUDE.
       DATE-WRITTEN. 2024-04-09.
      *****************************************************************
      * Daily Position Report Generator                                 *
      *                                                               *
      * This program generates the daily position report including:    *
      * - Portfolio position summary                                   *
      * - Transaction activity                                         *
      * - Exception reporting                                          *
      * - Performance metrics                                          *
      *****************************************************************
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT POSITION-MASTER ASSIGN TO POSMSTRE
               ORGANIZATION IS INDEXED
               ACCESS MODE IS SEQUENTIAL
               RECORD KEY IS POS-KEY
               FILE STATUS IS WS-POSITION-STATUS.

           SELECT TRANSACTION-HISTORY ASSIGN TO TRANHIST
               ORGANIZATION IS INDEXED
               ACCESS MODE IS SEQUENTIAL
               RECORD KEY IS TRAN-KEY
               FILE STATUS IS WS-TRAN-STATUS.

           SELECT REPORT-FILE ASSIGN TO RPTFILE
               ORGANIZATION IS SEQUENTIAL
               FILE STATUS IS WS-REPORT-STATUS.

*-- Change: Added real-time market price feed input file for dynamic valuation
           SELECT REALTIME-PRICE-FEED ASSIGN TO RTFEED
               ORGANIZATION IS SEQUENTIAL
               FILE STATUS IS WS-PRICEFEED-STATUS.

       DATA DIVISION.
       FILE SECTION.
           COPY POSREC.
           COPY TRNREC.

*-- Change: Add real-time price feed record structure
       FD  REALTIME-PRICE-FEED
           RECORDING MODE IS F
           BLOCK CONTAINS 0 RECORDS.
       01  REALTIME-PRICE-REC.
           05  RTP-INVESTMENT-ID   PIC X(10).
           05  RTP-PRICE           PIC S9(13)V9(4) COMP-3.
           05  RTP-TIMESTAMP       PIC X(26).

       FD  REPORT-FILE
           RECORDING MODE IS F
           BLOCK CONTAINS 0 RECORDS.
       01  REPORT-RECORD             PIC X(132).

       WORKING-STORAGE SECTION.
           COPY RTNCODE.
           COPY ERRHAND.

       01  WS-FILE-STATUS.
           05  WS-POSITION-STATUS    PIC XX.
           05  WS-TRAN-STATUS        PIC XX.
           05  WS-REPORT-STATUS      PIC XX.
*-- Change: Add price feed file status
           05  WS-PRICEFEED-STATUS   PIC XX.

*-- Change: Add real-time price and P&L calculation fields
       01  WS-REALTIME-PRICE        PIC S9(13)V9(4) COMP-3 VALUE 0.
       01  WS-REALTIME-TIMESTAMP    PIC X(26).
       01  WS-REALTIME-PNL          PIC S9(13)V9(2) COMP-3 VALUE 0.

       01  WS-REPORT-HEADERS.
           05  WS-HEADER1.
               10  FILLER            PIC X(132) VALUE ALL '*'.
           05  WS-HEADER2.
               10  FILLER            PIC X(40) VALUE SPACES.
               10  FILLER            PIC X(52) 
                   VALUE 'DAILY POSITION REPORT'.
               10  FILLER            PIC X(40) VALUE SPACES.
           05  WS-HEADER3.
               10  FILLER            PIC X(15) VALUE 'REPORT DATE:'.
               10  WS-REPORT-DATE    PIC X(10).
               10  FILLER            PIC X(107) VALUE SPACES.

       01  WS-POSITION-DETAIL.
           05  WS-POS-PORTFOLIO     PIC X(10).
           05  FILLER               PIC X(2) VALUE SPACES.
           05  WS-POS-DESCRIPTION   PIC X(30).
           05  FILLER               PIC X(2) VALUE SPACES.
           05  WS-POS-QUANTITY      PIC ZZZ,ZZZ,ZZ9.99.
           05  FILLER               PIC X(2) VALUE SPACES.
           05  WS-POS-VALUE         PIC $$$$,$$$,$$9.99.
           05  FILLER               PIC X(2) VALUE SPACES.
           05  WS-POS-CHANGE-PCT    PIC +ZZ9.99.
           05  FILLER               PIC X(40) VALUE SPACES.
*-- Change: Add real-time price and P&L to report detail
           05  WS-POS-REALTIME-PRICE   PIC $$$$,$$$,$$9.9999.
           05  FILLER                  PIC X(2) VALUE SPACES.
           05  WS-POS-REALTIME-PNL     PIC S$$$,$$$,$$9.99.
           05  FILLER                  PIC X(10) VALUE SPACES.
           05  WS-POS-REALTIME-TIME    PIC X(26).

       PROCEDURE DIVISION.
       0000-MAIN.
           PERFORM 1000-INITIALIZE
           PERFORM 2000-PROCESS-REPORT
           PERFORM 3000-CLEANUP
           GOBACK.

       1000-INITIALIZE.
           PERFORM 1100-OPEN-FILES
           PERFORM 1200-WRITE-HEADERS.

       1100-OPEN-FILES.
           OPEN INPUT POSITION-MASTER
           IF WS-POSITION-STATUS NOT = '00'
               MOVE 'ERROR OPENING POSITION MASTER'
                 TO WS-ERROR-MESSAGE
               PERFORM 9999-ERROR-HANDLER
           END-IF

           OPEN INPUT TRANSACTION-HISTORY
           IF WS-TRAN-STATUS NOT = '00'
               MOVE 'ERROR OPENING TRANSACTION HISTORY'
                 TO WS-ERROR-MESSAGE
               PERFORM 9999-ERROR-HANDLER
           END-IF

           OPEN OUTPUT REPORT-FILE
           IF WS-REPORT-STATUS NOT = '00'
               MOVE 'ERROR OPENING REPORT FILE'
                 TO WS-ERROR-MESSAGE
               PERFORM 9999-ERROR-HANDLER
           END-IF.

*-- Change: Open real-time price feed file
           OPEN INPUT REALTIME-PRICE-FEED
           IF WS-PRICEFEED-STATUS NOT = '00'
               MOVE 'ERROR OPENING REALTIME PRICE FEED'
                 TO WS-ERROR-MESSAGE
               PERFORM 9999-ERROR-HANDLER
           END-IF.

       1200-WRITE-HEADERS.
           ACCEPT WS-REPORT-DATE FROM DATE
           WRITE REPORT-RECORD FROM WS-HEADER1
           WRITE REPORT-RECORD FROM WS-HEADER2
           WRITE REPORT-RECORD FROM WS-HEADER3.

       2000-PROCESS-REPORT.
           PERFORM 2100-READ-POSITIONS
           PERFORM 2200-PROCESS-TRANSACTIONS
           PERFORM 2300-WRITE-SUMMARY.

       2100-READ-POSITIONS.
           READ POSITION-MASTER
               AT END SET END-OF-POSITIONS TO TRUE
           END-READ

           PERFORM UNTIL END-OF-POSITIONS
               PERFORM 2110-FORMAT-POSITION
               READ POSITION-MASTER
                   AT END SET END-OF-POSITIONS TO TRUE
               END-READ
           END-PERFORM.

       2110-FORMAT-POSITION.
           MOVE POS-PORTFOLIO-ID   TO WS-POS-PORTFOLIO
           MOVE POS-DESCRIPTION    TO WS-POS-DESCRIPTION
           MOVE POS-QUANTITY       TO WS-POS-QUANTITY
           MOVE POS-CURRENT-VALUE  TO WS-POS-VALUE
           COMPUTE WS-POS-CHANGE-PCT = 
               (POS-CURRENT-VALUE - POS-PREVIOUS-VALUE) /
                POS-PREVIOUS-VALUE * 100

*-- Change: Fetch real-time price for investment, calculate P&L, store timestamp
           PERFORM 2111-GET-REALTIME-PRICE
           COMPUTE WS-REALTIME-PNL = (WS-REALTIME-PRICE * POS-QUANTITY) - POS-COST-BASIS
           MOVE WS-REALTIME-PRICE    TO WS-POS-REALTIME-PRICE
           MOVE WS-REALTIME-PNL      TO WS-POS-REALTIME-PNL
           MOVE WS-REALTIME-TIMESTAMP TO WS-POS-REALTIME-TIME

           WRITE REPORT-RECORD FROM WS-POSITION-DETAIL.

*-- Change: Audit log for missing or stale price feed
           IF WS-REALTIME-PRICE = 0
               CALL 'AUDPROC' USING
                   'RPTPOS00' 'FEED' 'FAIL' POS-KEY
               END-CALL
           END-IF

       2111-GET-REALTIME-PRICE.
*-- Change: Read price feed and match investment id
           READ REALTIME-PRICE-FEED
               AT END
                   MOVE 0 TO WS-REALTIME-PRICE
                   MOVE SPACES TO WS-REALTIME-TIMESTAMP
                   EXIT PARAGRAPH
           END-READ
           IF RTP-INVESTMENT-ID = POS-INVESTMENT-ID
               MOVE RTP-PRICE TO WS-REALTIME-PRICE
               MOVE RTP-TIMESTAMP TO WS-REALTIME-TIMESTAMP
           ELSE
               MOVE 0 TO WS-REALTIME-PRICE
               MOVE SPACES TO WS-REALTIME-TIMESTAMP
           END-IF.

       2200-PROCESS-TRANSACTIONS.
           PERFORM 2210-READ-TRANSACTIONS
           PERFORM 2220-SUMMARIZE-ACTIVITY.

       2300-WRITE-SUMMARY.
           PERFORM 2310-WRITE-TOTALS
           PERFORM 2320-WRITE-EXCEPTIONS
           PERFORM 2330-WRITE-METRICS.

       3000-CLEANUP.
           CLOSE POSITION-MASTER
                TRANSACTION-HISTORY
                REPORT-FILE
*-- Change: Close real-time price feed file
                REALTIME-PRICE-FEED.

       9999-ERROR-HANDLER.
           DISPLAY WS-ERROR-MESSAGE
           MOVE 12 TO RETURN-CODE
           GOBACK.

[Summary Change Report]
- Added real-time price feed input file and record structure.
- Extended working-storage and report detail for real-time price, P&L, and timestamp.
- Modified 2000-PROCESS-REPORT and 2110-FORMAT-POSITION to fetch real-time prices, recalculate P&L, and log feed failures.
- Preserved COBOL formatting and added traceable inline comments.

[File 2] POSREC.cpy src/copybook/common/POSREC.cpy

      *****************************************************************
      * POSITION RECORD STRUCTURE
      * VERSION: 1.1
      * DATE: 2024
      *****************************************************************
       01  POSITION-RECORD.
           05  POS-KEY.
               10  POS-PORTFOLIO-ID   PIC X(08).
               10  POS-DATE           PIC X(08).
               10  POS-INVESTMENT-ID  PIC X(10).
           05  POS-DATA.
               10  POS-QUANTITY       PIC S9(11)V9(4) COMP-3.
               10  POS-COST-BASIS     PIC S9(13)V9(2) COMP-3.
               10  POS-MARKET-VALUE   PIC S9(13)V9(2) COMP-3.
               10  POS-CURRENCY       PIC X(03).
               10  POS-STATUS         PIC X(01).
                   88  POS-STATUS-ACTIVE  VALUE 'A'.
                   88  POS-STATUS-CLOSED  VALUE 'C'.
                   88  POS-STATUS-PEND    VALUE 'P'.
           05  POS-AUDIT.
               10  POS-LAST-MAINT-DATE   PIC X(26).
               10  POS-LAST-MAINT-USER   PIC X(08).
*-- Change: Add real-time price, P&L, and timestamp fields
           05  POS-REALTIME-PRICE       PIC S9(13)V9(4) COMP-3.
           05  POS-REALTIME-PNL         PIC S9(13)V9(2) COMP-3.
           05  POS-REALTIME-TIMESTAMP   PIC X(26).
           05  POS-FILLER               PIC X(20).
      *****************************************************************
      * FIELD DESCRIPTIONS:
      * POS-PORTFOLIO-ID : PORTFOLIO IDENTIFIER
      * POS-DATE         : POSITION DATE (YYYYMMDD)
      * POS-INVESTMENT-ID: INVESTMENT IDENTIFIER
      * POS-QUANTITY     : HOLDING QUANTITY
      * POS-COST-BASIS   : TOTAL COST BASIS
      * POS-MARKET-VALUE : CURRENT MARKET VALUE
      * POS-STATUS       : A=ACTIVE, C=CLOSED, P=PENDING
      * POS-REALTIME-PRICE: LATEST MARKET PRICE FROM FEED
      * POS-REALTIME-PNL  : LATEST PROFIT/LOSS CALCULATION
      * POS-REALTIME-TIMESTAMP: TIME OF LAST PRICE UPDATE
      *****************************************************************

[Summary Change Report]
- Added POS-REALTIME-PRICE, POS-REALTIME-PNL, and POS-REALTIME-TIMESTAMP fields to support real-time valuation and audit requirements.
- Reduced POS-FILLER to maintain record length.
- All changes are inline-commented and COBOL formatting is preserved.

[File 3] POSUPDT.cbl src/programs/batch/POSUPDT.cbl

      *-- Change: New batch program for position updates with real-time price and P&L logic
       IDENTIFICATION DIVISION.
       PROGRAM-ID. POSUPDT.
       AUTHOR. COBOLMOD.
       DATE-WRITTEN. 2024-06-10.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT POSITION-MASTER ASSIGN TO POSMSTRE
               ORGANIZATION IS INDEXED
               ACCESS MODE IS DYNAMIC
               RECORD KEY IS POS-KEY
               FILE STATUS IS WS-POSITION-STATUS.
           SELECT REALTIME-PRICE-FEED ASSIGN TO RTFEED
               ORGANIZATION IS SEQUENTIAL
               FILE STATUS IS WS-PRICEFEED-STATUS.

       DATA DIVISION.
       FILE SECTION.
           COPY POSREC.

       FD  REALTIME-PRICE-FEED
           RECORDING MODE IS F
           BLOCK CONTAINS 0 RECORDS.
       01  REALTIME-PRICE-REC.
           05  RTP-INVESTMENT-ID   PIC X(10).
           05  RTP-PRICE           PIC S9(13)V9(4) COMP-3.
           05  RTP-TIMESTAMP       PIC X(26).

       WORKING-STORAGE SECTION.
       01  WS-FILE-STATUS.
           05  WS-POSITION-STATUS    PIC XX.
           05  WS-PRICEFEED-STATUS   PIC XX.
       01  WS-REALTIME-PRICE        PIC S9(13)V9(4) COMP-3 VALUE 0.
       01  WS-REALTIME-TIMESTAMP    PIC X(26).
       01  WS-REALTIME-PNL          PIC S9(13)V9(2) COMP-3 VALUE 0.
       01  END-OF-FILE              PIC X VALUE 'N'.

       PROCEDURE DIVISION.
       0000-MAIN.
           PERFORM 1000-OPEN-FILES
           PERFORM 2000-UPDATE-POSITIONS UNTIL END-OF-FILE = 'Y'
           PERFORM 3000-CLOSE-FILES
           GOBACK.

       1000-OPEN-FILES.
           OPEN I-O POSITION-MASTER
           IF WS-POSITION-STATUS NOT = '00'
               DISPLAY 'ERROR OPENING POSITION MASTER'
               MOVE 'Y' TO END-OF-FILE
           END-IF
           OPEN INPUT REALTIME-PRICE-FEED
           IF WS-PRICEFEED-STATUS NOT = '00'
               DISPLAY 'ERROR OPENING REALTIME PRICE FEED'
               MOVE 'Y' TO END-OF-FILE
           END-IF.

       2000-UPDATE-POSITIONS.
           READ POSITION-MASTER NEXT
               AT END MOVE 'Y' TO END-OF-FILE
           END-READ
           IF END-OF-FILE = 'Y'
               EXIT PARAGRAPH
           END-IF

           PERFORM 2100-GET-REALTIME-PRICE

           IF WS-REALTIME-PRICE NOT = 0
               MOVE WS-REALTIME-PRICE TO POS-REALTIME-PRICE
               COMPUTE WS-REALTIME-PNL = (WS-REALTIME-PRICE * POS-QUANTITY) - POS-COST-BASIS
               MOVE WS-REALTIME-PNL TO POS-REALTIME-PNL
               MOVE WS-REALTIME-TIMESTAMP TO POS-REALTIME-TIMESTAMP
               REWRITE POSITION-RECORD
           ELSE
               DISPLAY 'REALTIME PRICE NOT FOUND FOR ' POS-INVESTMENT-ID
           END-IF.

       2100-GET-REALTIME-PRICE.
           READ REALTIME-PRICE-FEED
               AT END
                   MOVE 0 TO WS-REALTIME-PRICE
                   MOVE SPACES TO WS-REALTIME-TIMESTAMP
                   EXIT PARAGRAPH
           END-READ
           IF RTP-INVESTMENT-ID = POS-INVESTMENT-ID
               MOVE RTP-PRICE TO WS-REALTIME-PRICE
               MOVE RTP-TIMESTAMP TO WS-REALTIME-TIMESTAMP
           ELSE
               MOVE 0 TO WS-REALTIME-PRICE
               MOVE SPACES TO WS-REALTIME-TIMESTAMP
           END-IF.

       3000-CLOSE-FILES.
           CLOSE POSITION-MASTER
           CLOSE REALTIME-PRICE-FEED.

[Summary Change Report]
- Implemented new batch logic to update position records with real-time price, P&L, and timestamp.
- Reads from price feed, recalculates, and persists new values.
- Preserved COBOL formatting and added traceable inline comments.

[File 4] AUDPROC.cbl src/programs/common/AUDPROC.cbl

      *================================================================*
      * Program Name: AUDPROC
      * Description: Audit Trail Processing Subroutine
      * Author: [Author name]
      * Date Written: 2024-03-20
      *================================================================*
       IDENTIFICATION DIVISION.
       PROGRAM-ID. AUDPROC.

       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM-ZOS.
       OBJECT-COMPUTER. IBM-ZOS.

       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT AUDIT-FILE
               ASSIGN TO AUDFILE
               ORGANIZATION IS SEQUENTIAL
               FILE STATUS IS WS-FILE-STATUS.

       DATA DIVISION.
       FILE SECTION.
       FD  AUDIT-FILE
           RECORDING MODE IS F
           BLOCK CONTAINS 0 RECORDS.
           COPY AUDITLOG.

       WORKING-STORAGE SECTION.
       01  WS-FILE-STATUS          PIC X(2).
       01  WS-FORMATTED-TIME       PIC X(26).
*-- Change: Add alarm/error condition fields for feed monitoring
       01  WS-ALARM-TYPE           PIC X(10).
       01  WS-ALARM-MESSAGE        PIC X(100).

       LINKAGE SECTION.
       01  LS-AUDIT-REQUEST.
           05  LS-SYSTEM-INFO.
               10  LS-SYSTEM-ID    PIC X(8).
               10  LS-USER-ID      PIC X(8).
               10  LS-PROGRAM      PIC X(8).
               10  LS-TERMINAL     PIC X(8).
           05  LS-TYPE            PIC X(4).
           05  LS-ACTION          PIC X(8).
           05  LS-STATUS          PIC X(4).
           05  LS-KEY-INFO.
               10  LS-PORT-ID     PIC X(8).
               10  LS-ACCT-NO     PIC X(10).
           05  LS-BEFORE-IMAGE    PIC X(100).
           05  LS-AFTER-IMAGE     PIC X(100).
           05  LS-MESSAGE         PIC X(100).
           05  LS-RETURN-CODE     PIC S9(4) COMP.
*-- Change: Add alarm and error condition for feed monitoring
           05  LS-ALARM-TYPE      PIC X(10).
           05  LS-ALARM-MESSAGE   PIC X(100).

       PROCEDURE DIVISION USING LS-AUDIT-REQUEST.
       0000-MAIN.
           PERFORM 1000-INITIALIZE
           PERFORM 2000-PROCESS-AUDIT
           PERFORM 3000-TERMINATE
           GOBACK
           .

       1000-INITIALIZE.
           ACCEPT WS-FORMATTED-TIME FROM TIME STAMP

           OPEN EXTEND AUDIT-FILE
           IF WS-FILE-STATUS NOT = '00'
               DISPLAY 'Error opening audit file: ' WS-FILE-STATUS
               MOVE 8 TO LS-RETURN-CODE
               PERFORM 3000-TERMINATE
               GOBACK
           END-IF
           .

       2000-PROCESS-AUDIT.
           INITIALIZE AUDIT-RECORD

           MOVE WS-FORMATTED-TIME  TO AUD-TIMESTAMP
           MOVE LS-SYSTEM-INFO     TO AUD-HEADER
           MOVE LS-TYPE            TO AUD-TYPE
           MOVE LS-ACTION          TO AUD-ACTION
           MOVE LS-STATUS          TO AUD-STATUS
           MOVE LS-KEY-INFO        TO AUD-KEY-INFO
           MOVE LS-BEFORE-IMAGE    TO AUD-BEFORE-IMAGE
           MOVE LS-AFTER-IMAGE     TO AUD-AFTER-IMAGE
           MOVE LS-MESSAGE         TO AUD-MESSAGE

*-- Change: Store alarm and error condition for real-time feed monitoring
           IF LS-ALARM-TYPE NOT = SPACES
               MOVE LS-ALARM-TYPE TO AUD-ALARM-TYPE
               MOVE LS-ALARM-MESSAGE TO AUD-ALARM-MESSAGE
           END-IF

           WRITE AUDIT-RECORD

           IF WS-FILE-STATUS NOT = '00'
               DISPLAY 'Error writing audit record: ' WS-FILE-STATUS
               MOVE 8 TO LS-RETURN-CODE
           ELSE
               MOVE 0 TO LS-RETURN-CODE
           END-IF
           .

       3000-TERMINATE.
           CLOSE AUDIT-FILE
           .

[Summary Change Report]
- Enhanced linkage section and audit logic to support new alarm and error conditions for real-time feed monitoring.
- Preserved COBOL formatting and added traceable inline comments.

[File 5] AUDITLOG.cpy src/copybook/common/AUDITLOG.cpy

      *================================================================*
      * Copybook Name: AUDITLOG
      * Description: Audit Trail Record Definitions
      * Author: [Author name]
      * Date Written: 2024-03-20
      *================================================================*
       01  AUDIT-RECORD.
           05  AUD-HEADER.
               10  AUD-TIMESTAMP     PIC X(26).
               10  AUD-SYSTEM-ID     PIC X(8).
               10  AUD-USER-ID       PIC X(8).
               10  AUD-PROGRAM       PIC X(8).
               10  AUD-TERMINAL      PIC X(8).
           05  AUD-TYPE             PIC X(4).
               88  AUD-TRANSACTION     VALUE 'TRAN'.
               88  AUD-USER-ACTION     VALUE 'USER'.
               88  AUD-SYSTEM-EVENT    VALUE 'SYST'.
           05  AUD-ACTION           PIC X(8).
               88  AUD-CREATE         VALUE 'CREATE  '.
               88  AUD-UPDATE         VALUE 'UPDATE  '.
               88  AUD-DELETE         VALUE 'DELETE  '.
               88  AUD-INQUIRE        VALUE 'INQUIRE '.
               88  AUD-LOGIN          VALUE 'LOGIN   '.
               88  AUD-LOGOUT         VALUE 'LOGOUT  '.
               88  AUD-STARTUP        VALUE 'STARTUP '.
               88  AUD-SHUTDOWN       VALUE 'SHUTDOWN'.
           05  AUD-STATUS           PIC X(4).
               88  AUD-SUCCESS        VALUE 'SUCC'.
               88  AUD-FAILURE        VALUE 'FAIL'.
               88  AUD-WARNING        VALUE 'WARN'.
           05  AUD-KEY-INFO.
               10  AUD-PORTFOLIO-ID  PIC X(8).
               10  AUD-ACCOUNT-NO    PIC X(10).
           05  AUD-BEFORE-IMAGE     PIC X(100).
           05  AUD-AFTER-IMAGE      PIC X(100).
           05  AUD-MESSAGE          PIC X(100).
*-- Change: Add alarm and error condition fields for real-time feed monitoring
           05  AUD-ALARM-TYPE      PIC X(10).
           05  AUD-ALARM-MESSAGE   PIC X(100).

[Summary Change Report]
- Added AUD-ALARM-TYPE and AUD-ALARM-MESSAGE fields for real-time feed monitoring alarms/errors.
- All changes are inline-commented and COBOL formatting is preserved.
